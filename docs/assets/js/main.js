"use strict";const submitButton=document.getElementById("submitButton"),titleInput=document.getElementById("titleInput");let apiUrl="http://api.tvmaze.com/search/shows?q=",showList=null;const favShowList=getFromLocal();function fetchData(){const e=titleInput.value;fetch(apiUrl+e).then(e=>e.json()).then(e=>{showList=e,console.dir(showList),paintShows(showList),paintFavShows(favShowList)}).catch((function(e){console.log(e)}))}submitButton.addEventListener("click",fetchData);const showsListUl=document.getElementById("showsList");let paintFavShowList=document.getElementById("favShows");function paintShows(e){showsListUl.innerHTML="";for(let t of e){let e=t.show.name,o=document.createElement("li"),n=document.createElement("h3"),s=document.createTextNode(e),i=parseInt(t.show.id);o.classList.add("showsListing"),o.setAttribute("id",`${i}`);let a=t.show.image;if(null!==a){let e=document.createElement("img");e.src=`${a.medium}`,o.appendChild(e)}else if(null===a){let e=document.createElement("img");e.src="https://via.placeholder.com/210x295/ffffff/666666/? text=TV",o.appendChild(e)}n.appendChild(s),o.appendChild(n),showsListUl.appendChild(o),showToFavListener()}}function showToFavListener(){const e=document.querySelectorAll(".showsList li");for(let t of e)t.addEventListener("click",selectFavShow)}function selectFavShow(e){let t=getObjectById(parseInt(e.currentTarget.id)).show;favShowList.push(t),saveToLocal(),paintFavShows(favShowList)}function getObjectById(e){return showList.find(t=>t.show.id===e)}function paintFavShows(e){paintFavShowList.innerHTML="";for(let t of e){let e=document.createElement("li"),o=document.createElement("h4"),n=document.createElement("img"),s=document.createTextNode(`${t.name}`),i=document.createElement("button"),a=document.createTextNode("x");i.setAttribute("type","button"),i.setAttribute("id",`'${t.name}'`),i.classList.add("deleteButton"),e.classList.add("favShowLi"),e.setAttribute("id",`'${t.name}'`),i.appendChild(a),e.appendChild(i),o.appendChild(s),e.appendChild(o),null!==t.image?(n.src=`${t.image.medium}`,n.classList.add("favShowImg"),e.appendChild(n)):(n.src="https://via.placeholder.com/210x295/ffffff/666666/? text=TV",n.classList.add("favShowImg"),e.appendChild(n)),paintFavShowList.appendChild(e),removeFavListener()}}function saveToLocal(){localStorage.setItem("selectedShows",JSON.stringify(favShowList)),console.dir(favShowList)}function getFromLocal(){let e=JSON.parse(localStorage.getItem("selectedShows"));return null!==e?e:[]}function removeFavListener(){const e=document.querySelectorAll(".deleteButton");for(let t of e)t.addEventListener("click",removeFavShow)}function removeFavShow(e){const t=e.target.id,o=document.querySelectorAll(".favShows li");for(let e of o){let o=e.id;if(o===t){e.remove();const t=favShowList.indexOf(o);favShowList.splice(t),saveToLocal()}}}